<app-aside-content-wrapper>
  <div topLeft><app-logo></app-logo></div>

  <div topRight class="flex flex-col items-end gap-2">
    <p>Schon registriert?</p>
    <a routerLink="/login" class="dab-anchor-on-bg -mr-4">Anmelden</a>
  </div>

  <div footer class="flex justify-between gap-4">
    <a routerLink="/legal-notice" class="dab-anchor-on-bg">Impressum</a>
    <a routerLink="/privacy-policy" class="dab-anchor-on-bg">Datenschutz</a>
  </div>

  <div card>
    @if (!isAvatarStep) {
      <button
        type="button"
        aria-label="Zurück zur Anmeldung"
        class="dab-ui-item back-btn leading-0"
        (click)="onBackToLogin()">
        <span class="material-icons">arrow_back</span>
      </button>

      <header class="mb-10">
        <h1>Konto erstellen</h1>
        <p class="text-center text-base sm:text-lg">
          Registriere dich mit Namen und E-Mail-Adresse oder nutze den <a routerLink="/login">Google Login</a>.
        </p>
      </header>

      <form #signupForm="ngForm" (ngSubmit)="onSubmit(signupForm)" novalidate class="dab-form">
        <!-- @if (false && errorMessage) {
          <p class="rounded-2xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-600">
            {{ errorMessage }}
          </p>
        } -->

        <div>
          <div class="dab-input-field">
            <label for="fullName" class="sr-only">Name und Nachname</label>
            <span class="material-icons icon">person_outlined</span>
            <input
              id="fullName"
              name="fullName"
              type="text"
              autocomplete="name"
              required
              placeholder="Name und Nachname"
              [(ngModel)]="name"
              #nameModel="ngModel" />
          </div>
          @if (nameModel.invalid && nameModel.touched) {
            <p class="dab-field-error">Bitte gib deinen Namen ein.</p>
          }
        </div>

        <div>
          <div class="dab-input-field">
            <label for="email" class="sr-only">E-Mail</label>
            <span class="material-icons icon">mail_outlined</span>
            <input
              id="email"
              name="email"
              type="email"
              pattern="^[A-Za-z0-9._%+\-]+@[A-Za-z0-9.\-]+\.[A-Za-z]{2,}$"
              autocomplete="email"
              required
              placeholder="beispielname@email.com"
              [(ngModel)]="emailAddress"
              #emailModel="ngModel" />
          </div>
          @if (emailModel.invalid && emailModel.touched) {
            <p class="dab-field-error">Bitte gib deine E-Mail-Adresse ein.</p>
          }
        </div>

        <div>
          <div class="dab-input-field">
            <label for="password" class="sr-only">Passwort</label>
            <span class="material-icons icon">lock_outlined</span>
            <input
              id="password"
              name="password"
              type="password"
              autocomplete="new-password"
              required
              placeholder="Passwort"
              [(ngModel)]="password"
              #passwordModel="ngModel" />
          </div>
          @if (passwordModel.invalid && passwordModel.touched) {
            <p class="dab-field-error">Bitte gib dein Passwort ein.</p>
          }

          <!-- @if (false && passwordValidationErrors.length > 0) {
            <ul class="mt-2 space-y-1 px-2 text-xs text-dab-rosa-error">
              @for (message of passwordValidationErrors; track $index) {
                <li class="flex gap-2">
                  <span>•</span>
                  <span>{{ message }}</span>
                </li>
              }
            </ul>
          } -->
        </div>

        <div>
          <mat-checkbox required [(ngModel)]="privacyAccepted" #privacyModel="ngModel" class="custom-checkbox">
            Ich stimme der
            <a routerLink="/privacy-policy" class="dab-anchor-on-white-inline">Datenschutzerklärung</a>
            zu.
          </mat-checkbox>
          @if (privacyModel.invalid && privacyModel.touched) {
            <p class="dab-field-error">Bitte akzeptiere die Datenschutzerklärung.</p>
          }
        </div>

        <div class="flex justify-end">
          <button type="submit" [disabled]="isSubmitting || signupForm.invalid" class="dab-btn-primary">Weiter</button>
        </div>
      </form>
    } @else {
      <app-set-profile-picture
        [displayName]="name"
        [selectedProfilePictureKey]="selectedProfilePictureKey"
        [actionLabel]="isSubmitting ? 'Konto wird erstellt …' : 'Konto jetzt erstellen'"
        [isActionDisabled]="isSubmitting"
        (profilePictureChange)="onProfilePictureChange($event)"
        (back)="onBackFromAvatarStep()"
        (action)="onCompleteSignup()">
      </app-set-profile-picture>

      <!-- @if (false && errorMessage) {
        <p class="mt-4 rounded-2xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-600">
          {{ errorMessage }}
        </p>
      } -->
    }
  </div>
</app-aside-content-wrapper>

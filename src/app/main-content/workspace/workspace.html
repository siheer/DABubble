<app-create-channel *ngIf="isCreateChannelOpen" (close)="closeCreateChannel()"></app-create-channel>
<aside class="workspace">
  <header class="workspace__header">
    <div class="workspace__brand">
      <img src="imgs/workspace/Workspace logo.png" alt="Workspace Logo" />
      <div class="workspace__titles">
        <h1>Devspace</h1>
        <p>Organisiere deine Channels</p>
      </div>
    </div>
    <button class="workspace__icon-btn" type="button" aria-label="Neue Nachricht" (click)="startNewMessage()">
      <img src="imgs/workspace/new message.png" alt="Neue Nachricht" />
    </button>
  </header>

  <nav class="workspace__nav">
    <div class="workspace__section">
      <div class="workspace__section-header">
        <div class="workspace__section-title">
          <button
            class="workspace__chevron"
            type="button"
            (click)="toggleChannels()"
            [attr.aria-expanded]="!areChannelsCollapsed"
            aria-controls="workspace-channels">
            {{ areChannelsCollapsed ? '▸' : '▾' }}
          </button>
          <img src="imgs/workspace/channellist img.png" alt="Kanäle" />
          <span>Kanäle</span>
        </div>
        <button
          class="workspace__icon-btn workspace__icon-btn--ghost"
          type="button"
          aria-label="Neuen Channel hinzufügen"
          (click)="openCreateChannel()"></button>
      </div>
      <ng-container *ngIf="!areChannelsCollapsed">
        <ul class="workspace__list" id="workspace-channels">
          <li *ngFor="let channel of channels$ | async">
            <button
              class="workspace__list-item"
              type="button"
              [class.workspace__list-item--active]="(selectedChannelId$ | async) === channel.id"
              (click)="selectChannel(channel.id)">
              <span># {{ channel.title || 'Unbenannter Channel' }}</span>
            </button>
          </li>
        </ul>
        <button class="workspace__add-btn" type="button" (click)="openCreateChannel()">
          <img src="imgs/workspace/add new channel.png" alt="Neuen Channel anlegen" />
          <span>Neuen Channel anlegen</span>
        </button>
      </ng-container>
    </div>
    <div class="workspace__section">
      <div class="workspace__section-header">
        <div class="workspace__section-title">
          <button
            class="workspace__chevron"
            type="button"
            (click)="toggleDirectMessages()"
            [attr.aria-expanded]="!areDirectMessagesCollapsed"
            aria-controls="workspace-direct-messages">
            {{ areDirectMessagesCollapsed ? '▸' : '▾' }}
          </button>
          <img src="imgs/direktnachrichten img.svg" alt="Direktnachrichten" />
          <span>Direktnachrichten</span>
        </div>
      </div>
      <ul
        *ngIf="!areDirectMessagesCollapsed"
        class="workspace__list workspace__list--direct"
        id="workspace-direct-messages">
        <ng-container *ngIf="users$ | async as users">
          <li *ngFor="let user of users" class="workspace__list-item">
           <button
              type="button"
              class="workspace__list-item workspace__list-item--direct"
              [class.workspace__list-item--active]="(selectedDirectMessageUser$ | async)?.uid === user.uid"
              (click)="openDirectMessage(user)">
              <img
                class="workspace__avatar"
                [src]="user.photoUrl || 'imgs/default-profile-picture.png'"
                [alt]="user.name" />
              <div class="workspace__user-details">
                <span class="workspace__user-name">{{ user.name }}</span>
                <span class="workspace__user-email">{{ user.email || 'Keine E-Mail hinterlegt' }}</span>
              </div>
            </button>
          </li>
        </ng-container>
      </ul>
    </div>
  </nav>
</aside>
